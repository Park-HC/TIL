# 반정규화

## 개요

- 데이터의 조회 성능을 향상시키기 위해 데이터의 **중복을 허용**하거나 **데이터를 통합 및 분리**하는 과정
- 조회 성능을 향상 시키는 대신 입력, 수정, 삭제 성능은 저하될 수 있으므로 **데이터 정합성 이슈 발생 가능**
- **정규화가 끝난 후 반정규화 진행**
- **규칙**에 의해 반정규화 진행
  - 반정규화 대상 조사
  - 다른 방법 검토 후
  - 안 되면 반정규화



## 필요성

- 지나친 정규화는 특정 정보에 접근하는 데 필요한 접속 수를 늘릴 수 있음
- '적절한' 반정규화를 통해 탐색 성능을 높여야 함



## 테이블 반정규화

### 테이블 병합

- 업무상 JOIN이 필요한 경우가 많아 테이블을 통합하는 것이 성능 측면에서 유리할 경우
- 1:M 병합의 경우, 1쪽 엔티티의 속성이 많으면 중복 데이터가 많아질 가능성 있음

#### 슈퍼/서브 타입 병합

- 슈퍼타입: 공통부분
- 서브엔티티: 공통부분을 상속받아 다른 엔터티와 차이가 있는 속성

#### 

### 테이블 분할

#### 수직 분할

- 엔티티의 일부 속성을 별도의 엔티티로 분할(1:1 관계 성립)
- 자주 쓰는 속성이 아니거나 대부분의 인스턴가 NULL인 경우 고려

#### 수평 분할

- 엔티티의 인스턴스들을 일정 기준에 따라 변도의 엔티티로 분할(분할된 엔티티간 관계 없음, 파티셔닝)

##### 파티셔닝

- PK에 의해 테이블을 분할하는 방법
- Range Partition: 대상 테이블이 날짜 또는 숫자값으로 분리 가능하고 각 영역별로 트랙잭션이 분리되는 경우
- List Partition: 지점, 사업소 등 핵심적인 코드값으로 PK가 구성되어 있고 대량의 데이터가 있는 테이블의 경우
- Harsh Partition



### 테이블 추가

#### 중복 테이블 추가

- 성능을 고려해 중복 허용

#### 통계 테이블 추가

- 월매출, 이자 등 통계치를 자주 사용하는 경우

#### 이력 테이블 추가

- 과거 데이터 등

#### 부분 테이블 추가

- 어느 엔티티의 특정 속성들이 자주 쓰일 경우 그 속성들만 모아서 엔티티 만듦



## 컬럼 반정규화

### 중복 컬럼 추가

- JOIN이 필요한 경우가 많아 컬럼을 추가하는 것이 성능상 나을 경우

### 파생 컬럼 추가

- 부하가 염려되는 계산 값을 미리 컬럼으로 추가하여 보관

### 이력 테이블 칼럼 추가

- 이력 테이블 조회 기준이 될 것을 판단되는 컬럼을 미리 추가해 놓는 방식
- 최신 데이터 여부 등

### PK에 의한 카럼 추가

### 응용시스템 오작동 위한 컬럼 추가



## 관계 반정규화

- 중복관계 추가
- **데이터 무결성에 영향 없음**